# 呈尚策划数据统计系统

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Version](https://img.shields.io/badge/version-v2.1.0-green.svg)](CHANGELOG.md)
[![Platform](https://img.shields.io/badge/platform-Web-orange.svg)](README.md)

## 项目简介

呈尚策划数据统计系统是一个专业的Excel/CSV数据分析工具集，提供现代化的Web界面和强大的数据处理能力。系统包含五个核心功能模块：

- **🍔 饿了么门店ID统计专业版**：专为饿了么平台设计的代运营结算统计系统
- **🍱 美团门店ID统计专业版**：专为美团平台设计的门店ID数据分析平台
- **📊 店铺数据可视化**：CSV数据的多维度趋势分析
- **🔧 服务商统计模块**：对服务商结算数据进行多维度分析
- **🍜 饿了么服务商统计**：专为饿了么平台设计的代运营账单多维度分析系统 ⭐ **最新**

## 🌟 项目亮点

- 🎯 **平台专属适配**：针对饿了么和美团平台分别设计专属模块，完美适配各平台账单格式
- 📊 **多维度数据分析**：支持按日期、按门店、按绩效等多个维度进行数据统计和分析
- 🎨 **品牌主题设计**：每个模块都有独特的品牌色主题设计，提供专业的视觉体验
- 📈 **可视化图表**：基于ECharts的专业数据可视化，直观展示数据趋势
- 🚀 **现代化体验**：拖拽上传、实时统计、响应式设计，提供流畅的用户体验
- 💾 **智能导出**：支持Excel报告和PNG图表导出，方便数据分享和存档

## 功能特性

### 🍔 饿了么门店ID统计专业版 (`eleme-pro`)
- 🎨 **饿了么主题设计**：蓝色渐变背景、现代化UI界面
- 🍜 **饿了么账单支持**：完美适配饿了么周期账单Excel格式
- 📊 **批量门店统计**：支持批量输入9位门店ID，自动统计代运营结算金额
- 💰 **智能金额汇总**：自动计算每个门店的结算金额和结算天数
- 📈 **实时数据展示**：动态统计卡片显示查询门店数、找到数据门店数、总结算天数、金额汇总
- 🚀 **拖拽上传**：支持拖拽Excel文件上传
- 📋 **专业报告导出**：生成详细的Excel统计报告
- 💡 **绩效自动计算**：支持设置绩效比例，自动计算绩效金额

### 🍱 美团门店ID统计专业版 (`mendianid-pro`)
- 🎨 **现代化UI设计**：美团主题渐变背景、毛玻璃效果、响应式布局
- 🍱 **美团账单支持**：完美适配美团代运营账单Excel格式
- 🚀 **拖拽上传**：支持拖拽Excel文件上传
- 📊 **实时统计卡片**：动态显示关键指标
- 🔍 **智能数据检测**：自动识别Excel格式和字段
- 💡 **专业图标库**：使用Font Awesome图标
- 📈 **动态绩效计算**：实时计算和显示绩效金额
- 📋 **专业报告导出**：生成详细的Excel统计报告
- 🎯 **精确门店ID匹配**：基于8位门店ID精确匹配，避免商家名称变更问题

### 📊 店铺数据可视化模块 (`dianpushujukeshihua`)
- 📁 **CSV数据导入**：支持CSV格式数据文件
- 📈 **多维度趋势分析**：6种核心指标可视化
- 🎯 **关键指标监控**：
  - 📊 曝光量趋势
  - 👆 点击量变化
  - 💰 花费金额统计
  - 🎯 点击率分析
  - 💵 平均点击花费
  - 🔄 转化率监控
- 🎨 **交互式图表**：基于ECharts的专业图表
- 📱 **响应式设计**：完美适配各种设备

### 🔧 服务商统计模块 (`fuwushangtongji`)
- 📁 Excel数据文件处理
- 📊 每日店铺数量和结算额统计
- 🏬 店铺结算总额和天数分析
- 📈 ECharts可视化图表
- 💾 多格式数据导出
- 🖼️ 图表保存为图片

### 🍜 饿了么服务商统计 (`eleme-fuwushang`) ⭐ **最新版本**
- 🎨 **饿了么主题设计**：蓝色渐变背景、饿了么品牌色设计
- 📊 **按日期统计**：统计每天门店数量和结算总额
- 🏬 **按门店统计**：统计每个门店结算金额和天数
- 📈 **饿了么主题图表**：双图表展示门店数量趋势和结算金额趋势
- 💾 **智能导出**：Excel报告自动导出，带时间戳文件名
- 🖼️ **图表保存**：支持PNG格式高清图表导出
- 🍜 **完美适配**：专为饿了么周期账单格式设计

## 技术架构

### 前端技术栈
- **UI框架**: Layui 2.9.0
- **图标库**: Font Awesome 6.4.0
- **图表库**: ECharts 5.4.3
- **Excel处理**: XLSX.js 0.18.5
- **模块化**: ES6 Modules
- **样式**: CSS3 + Flexbox/Grid + 渐变效果
- **交互**: 拖拽上传、响应式设计

### 项目结构
```
呈尚策划数据统计系统/
├── index.html                   # 主页面入口
├── favicon.svg                  # 网站图标
├── eleme-pro/                   # 饿了么门店ID统计专业版 ⭐ 最新
│   ├── index.html              # 饿了么专业版主页面
│   └── assets/
│       ├── js/main.js          # 饿了么专业版核心逻辑
│       └── css/styles.css      # 饿了么专业版样式
├── mendianid-pro/               # 美团门店ID统计专业版
│   ├── index.html              # 美团专业版主页面
│   └── assets/
│       ├── js/main.js          # 美团专业版核心逻辑
│       └── css/styles.css      # 美团专业版样式
├── dianpushujukeshihua/         # 店铺数据可视化模块
│   ├── index.html              # 可视化主页面
│   └── assets/
│       └── js/main.js          # 可视化核心逻辑
├── fuwushangtongji/             # 服务商统计模块
│   ├── index.html              # 主页面
│   ├── main.js                 # 主程序入口
│   ├── dataProcessor.js        # 数据处理器
│   ├── chartRenderer.js        # 图表渲染器
│   ├── utils.js                # 工具函数
│   └── styles.css              # 样式文件
├── eleme-fuwushang/             # 饿了么服务商统计模块 ⭐ 最新
│   ├── index.html              # 饿了么服务商主页面
│   ├── main.js                 # 饿了么主程序入口
│   ├── dataProcessor.js        # 饿了么数据处理器
│   ├── chartRenderer.js        # 饿了么图表渲染器
│   └── utils.js                # 饿了么工具函数
├── README.md                   # 项目文档
└── CLAUDE.md                   # 开发指南
```

### 核心模块说明

#### 🍔 饿了么门店ID统计专业版架构
- **main.js**: 饿了么专用业务逻辑，支持饿了么账单格式解析
- **功能流程**: 拖拽上传饿了么账单 → 智能解析 → 门店ID批量匹配 → 代运营结算金额统计 → 绩效计算 → 专业报告导出
- **核心特性**:
  - 支持饿了么周期账单Excel格式（9位门店ID）
  - 自动识别"门店id"、"代运营结算金额"、"门店名称"、"账单日期"字段
  - 按账单日期去重计算结算天数
  - 实时统计卡片显示关键指标

#### 🍱 美团门店ID统计专业版架构
- **main.js**: 美团专业版核心逻辑，现代化的数据处理引擎
- **功能特性**:
  - 完美适配美团代运营账单格式
  - 智能Excel格式检测（支持特殊标题行）
  - 拖拽上传和文件验证
  - 实时统计卡片更新
  - 专业图标库集成
  - 动态绩效计算
- **功能流程**: 拖拽上传 → 智能解析 → 门店ID匹配 → 实时统计 → 可视化展示 → 专业报告导出

#### 📊 店铺数据可视化模块架构
- **main.js**: 可视化核心逻辑，基于ECharts的数据分析引擎
- **功能特性**:
  - CSV数据解析和验证
  - 6种核心指标计算
  - 交互式图表渲染
  - 趋势分析算法
- **功能流程**: CSV上传 → 数据解析 → 指标计算 → 图表渲染 → 趋势分析

#### 🔧 服务商统计模块架构
- **main.js**: 程序入口和事件绑定
- **dataProcessor.js**: 数据处理核心类，负责Excel解析和数据分析
- **chartRenderer.js**: 图表渲染类，基于ECharts实现数据可视化
- **utils.js**: 工具函数集合，包含表格创建、数据导出等

#### 🍜 饿了么服务商统计模块架构 ⭐ **最新**
- **index.html**: 饿了么主题页面，蓝色渐变设计
- **main.js**: 程序入口，饿了么账单事件处理
- **dataProcessor.js**: 饿了么数据处理核心类
  - `processExcelFile()`: 处理饿了么周期账单Excel
  - `analyzeDailySummary()`: 按账单日期统计门店数和结算额
  - `analyzeStoreSummary()`: 按门店名称+门店id统计金额和天数
  - `getChartData()`: 生成图表数据
- **chartRenderer.js**: 饿了么主题图表渲染器
  - 支持双图表：门店数量趋势、结算金额趋势
  - 饿了么品牌色：#0089ff（蓝色）、#00d170（绿色）
- **utils.js**: 饿了么专用工具函数
  - 表格创建、Excel导出、图表保存
  - 饿了么主题样式适配

## 安装指南

### 环境要求
- 现代浏览器（Chrome 80+, Firefox 75+, Safari 13+）
- 支持ES6模块的环境
- 网络连接（用于加载CDN资源）

### 部署步骤

1. **克隆项目**
```bash
git clone [项目地址]
cd 呈尚策划数据统计系统
```

2. **启动本地服务器**
```bash
# 使用Python
python -m http.server 8000

# 或使用Node.js
npx serve .

# 或使用PHP
php -S localhost:8000
```

3. **访问应用**
- 主页面: `http://localhost:8000/`
- 饿了么门店ID统计专业版: `http://localhost:8000/eleme-pro/`
- 美团门店ID统计专业版: `http://localhost:8000/mendianid-pro/`
- 店铺数据可视化: `http://localhost:8000/dianpushujukeshihua/`
- 服务商统计: `http://localhost:8000/fuwushangtongji/`
- 饿了么服务商统计: `http://localhost:8000/eleme-fuwushang/` ⭐ **最新**

### 快捷键导航
在主页面可以使用键盘快捷键快速访问各模块：
- **按键 1**: 饿了么门店ID统计专业版
- **按键 2**: 美团门店ID统计专业版
- **按键 3**: 服务商统计模块
- **按键 4**: 饿了么服务商统计 ⭐ **最新**

## 使用说明

### 🍔 饿了么门店ID统计专业版使用流程 ⭐ **最新**

1. **数据准备**
   - 准备饿了么周期账单Excel文件，包含以下字段：
     - 合同编号、门店id、合同类型、代运营结算金额、代运营收入、技术服务费（抽佣）、结算类型、入账状态、代运营服务编号、门店名称、入账日期、账单日期、合同状态

2. **操作步骤**
   ```
   拖拽上传饿了么账单Excel → 批量输入门店ID（9位数字） → 设置绩效百分比 → 开始分析 → 查看实时统计 → 导出专业报告
   ```

3. **核心功能**
   - **🍜 饿了么专用**: 完美适配饿了么周期账单格式
   - **📊 批量统计**: 支持批量输入门店ID，一键统计所有门店
   - **💰 智能汇总**: 自动计算每个门店的代运营结算金额和结算天数
   - **🎨 实时展示**: 动态统计卡片实时显示查询门店总数、找到数据门店、总结算天数、汇总金额
   - **📋 专业报告**: 生成包含汇总统计和绩效计算的详细Excel报告

4. **输入格式**
   - 门店ID：每行一个9位数字，如：536525267
   - 绩效百分比：数字格式，如：10（表示10%）

### 🍱 美团门店ID统计专业版使用流程

1. **数据准备**
   - 准备美团代运营账单Excel文件，包含以下字段：
     - 日期、商家名称、门店ID、结算周期、费用类型、结算金额(元)、扣费说明
   - 支持特殊格式Excel（如第一行为"代运营账单"标题）

2. **操作步骤**
   ```
   拖拽上传美团账单Excel → 批量输入门店ID列表 → 设置绩效百分比 → 开始分析 → 查看实时统计 → 导出专业报告
   ```

3. **专业版特性**
   - **🍱 美团专用**: 完美适配美团代运营账单格式
   - **🎨 现代化界面**: 美团主题渐变背景、毛玻璃效果、专业图标
   - **🚀 拖拽上传**: 支持拖拽Excel文件，自动格式检测
   - **📊 实时统计**: 动态显示查询门店总数、找到数据门店、总结算天数、汇总金额
   - **💡 智能提示**: 清晰说明"未找到数据"表示当月无抽点收入
   - **📋 专业报告**: 生成包含汇总统计和绩效计算的详细Excel报告
   - **🎯 精确匹配**: 基于8位门店ID进行精确匹配，避免商家名称变更问题

4. **输入格式**
   - 门店ID：每行一个8位数字，如：29403177
   - 绩效百分比：数字格式，默认10%

### 📊 店铺数据可视化模块使用流程

1. **数据准备**
   - 准备包含以下字段的CSV文件：
     - 日期、曝光量、点击量、花费、点击率、平均点击花费、转化数

2. **操作步骤**
   ```
   上传CSV文件 → 自动数据解析 → 查看6种指标趋势图 → 分析数据变化
   ```

3. **可视化指标**
   - **📊 曝光量趋势**: 展示广告曝光量的时间变化
   - **👆 点击量变化**: 分析用户点击行为趋势
   - **💰 花费金额统计**: 监控广告投入成本
   - **🎯 点击率分析**: 评估广告效果
   - **💵 平均点击花费**: 成本效益分析
   - **🔄 转化率监控**: 转化效果追踪

3. **输入格式**
   - 店铺名称：每行一个，支持模糊匹配
   - 绩效百分比：数字格式，如：15（表示15%）

### 服务商统计模块使用流程

1. **数据导入**
   - 上传Excel格式的结算数据文件

2. **分析操作**
   ```
   文件上传 → 店铺数和结算额分析 → 店铺结算统计分析 → 生成图表 → 导出结果
   ```

3. **功能说明**
   - **分析1**: 统计每天的店铺数量和结算总额
   - **分析2**: 统计每个店铺的结算总额和结算天数
   - **图表**: 生成可视化图表展示数据趋势

### 🍜 饿了么服务商统计使用流程 ⭐ **最新**

1. **数据准备**
   - 准备饿了么周期账单Excel文件，包含以下字段：
     - 合同编号、门店id、合同类型、代运营结算金额、代运营收入、技术服务费（抽佣）、结算类型、入账状态、代运营服务编号、门店名称、入账日期、账单日期、合同状态

2. **操作步骤**
   ```
   上传饿了么账单Excel → 初始化（可选） → 按日期统计 → 按门店统计 → 生成图表 → 导出报告
   ```

3. **核心功能**
   - **📊 按日期统计**: 统计每个账单日期的门店数量和结算金额总和，支持总额显示
   - **🏬 按门店统计**: 统计每个门店的总结算金额和结算天数，按金额降序排序
   - **📈 图表可视化**: 生成双图表展示门店数量趋势和结算金额趋势
   - **💾 智能导出**: 支持导出表格1（按日期统计）和表格2（按门店统计）为Excel
   - **🖼️ 图表保存**: 支持将图表保存为高清PNG图片

4. **特色功能**
   - **🍜 饿了么适配**: 完美支持饿了么周期账单字段结构
   - **🎨 主题设计**: 饿了么蓝色主题，渐变背景和图表配色
   - **🔄 数据初始化**: 支持一键重置所有数据和图表
   - **📅 日期去重**: 自动按账单日期去重统计结算天数
   - **🏪 门店分组**: 按门店名称+门店id组合键分组统计

## API文档

### 绩效统计模块核心函数

#### `readExcelFile(file)`
读取并解析Excel文件
- **参数**: `file` - File对象
- **返回**: Promise<Array> - 解析后的数据数组
- **异常**: 文件格式错误、解析失败

#### `analyzeData(data, shops)`
分析店铺数据
- **参数**: 
  - `data` - Excel数据数组
  - `shops` - 店铺名称数组
- **功能**: 计算各店铺结算天数和金额汇总

#### `calculatePerformance()`
计算绩效金额
- **功能**: 根据总金额和绩效百分比计算绩效

### 服务商统计模块核心类

#### `DataProcessor`
数据处理器类
```javascript
// 处理Excel文件
async processExcelFile(file)

// 分析每日汇总
analyzeDailySummary()

// 分析店铺汇总  
analyzeStoreSummary()

// 获取图表数据
getChartData()
```

#### `ChartRenderer`
图表渲染器类
```javascript
// 渲染图表
render(data)

// 获取当前图表实例
getCurrentChart()

// 调整图表大小
resize()
```

## 配置说明

### CDN资源配置
```html
<!-- Layui框架 -->
<link rel="stylesheet" href="https://unpkg.com/layui@2.9.0/dist/css/layui.css">
<script src="https://unpkg.com/layui@2.9.0/dist/layui.js"></script>

<!-- Font Awesome图标库 -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- Excel处理库 -->
<script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<!-- 图表库 -->
<script src="https://unpkg.com/echarts@5.4.3/dist/echarts.min.js"></script>
```

### 样式主题配置
- 主色调：`#1890ff`（蓝色系）
- 成功色：`#52c41a`（绿色）
- 背景色：`#f8f9fa`（浅灰）
- 卡片阴影：`0 2px 12px 0 rgba(0,0,0,0.1)`

## 开发指南

### 代码规范
- 使用ES6+语法
- 采用模块化开发
- 函数命名使用驼峰命名法
- 类名使用帕斯卡命名法
- 常量使用大写下划线命名

### 错误处理
- 所有异步操作使用try-catch包装
- 用户友好的错误提示
- 详细的控制台错误日志

### 性能优化
- 大文件处理使用流式读取
- 图表渲染防抖处理
- DOM操作批量更新

## 常见问题

### Q: Excel文件上传失败？
A: 请检查文件格式是否为.xlsx或.xls，文件大小不超过10MB

### Q: 数据分析结果为空？
A: 请确认Excel文件包含必要的字段，且店铺名称输入正确

### Q: 图表显示异常？
A: 请检查网络连接，确保ECharts库正常加载

### Q: 导出功能不工作？
A: 请确保浏览器支持文件下载，检查是否被弹窗拦截

## 更新日志

### v2.1.0 (2025-01-07) ⭐ **最新版本**
- ✨ **新增饿了么服务商统计模块** (`eleme-fuwushang`)
  - 🍜 专为饿了么平台设计的代运营账单分析系统
  - 📊 按账单日期统计门店数量和结算金额总和
  - 🏬 按门店统计总结算金额和结算天数
  - 📈 双图表可视化展示门店数量趋势和结算金额趋势
  - 🎨 饿了么蓝色主题设计 (#0089ff)
  - 💾 Excel报告和PNG图表智能导出
  - 🍔 完美适配饿了么周期账单格式

- 🔧 **优化调整**
  - 修改eleme-pro和mendianid-pro绩效比例默认值为3%
  - 优化主页面布局，新增饿了么服务商统计卡片
  - 新增键盘快捷键4：快速访问饿了么服务商统计

- 📚 **文档更新**
  - 更新README.md添加饿了么服务商统计详细说明
  - 完善模块架构文档
  - 添加使用流程和特色功能说明

### v2.0.0 (2025-01-05)
- ✨ **新增门店ID统计专业版**
  - 🎨 现代化UI设计，渐变背景和毛玻璃效果
  - 🚀 支持拖拽上传Excel文件
  - 📊 实时统计卡片显示关键指标
  - 💡 专业图标库替换emoji
  - 🔍 智能Excel格式检测
  - 📋 专业报告导出功能

- ✨ **新增店铺数据可视化模块**
  - 📁 CSV数据导入和解析
  - 📈 6种核心指标可视化
  - 🎯 多维度趋势分析
  - 📊 交互式ECharts图表

- 🔄 **主页面优化**
  - 移除基础版门店ID统计
  - 优化卡片布局和导航
  - 更新键盘快捷键

- 📚 **文档完善**
  - 更新README.md
  - 完善开发指南
  - 添加使用说明

### v1.0.0 (2024-12-XX)
- ✨ 初始版本发布
- 🎯 绩效统计模块完成
- 🏪 门店ID统计基础版完成
- 📊 服务商统计模块完成
- 🎨 UI界面优化
- 📱 响应式设计支持

## 许可证

本项目为开源项目，可自由使用和修改。

## 演示截图

### 主页面
![主页面](docs/images/homepage.png)

### 门店ID统计专业版
![门店ID统计专业版](docs/images/mendianid-pro.png)

### 店铺数据可视化
![店铺数据可视化](docs/images/data-visualization.png)

## 贡献指南

欢迎提交Issue和Pull Request来改进项目！

1. Fork 项目
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开 Pull Request

## 联系方式

- 开发团队：呈尚策划
- 项目地址：https://github.com/XUXIKAI886/chengshangcehshujutongji
- 在线演示：[演示地址]

## 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

---

© 2025 呈尚策划 - 保留所有权利