# 饿了么固定费用统计 - 使用说明

## 🎯 快速开始

### 第一步: 启动应用

```bash
# 在项目根目录 jixiaotongji/ 执行
python -m http.server 8000
```

### 第二步: 访问应用

在浏览器中打开:
```
http://localhost:8000/daiyunying-pro/
```

或者从主页进入:
```
http://localhost:8000/
按键盘 "5" 或点击"饿了么固定费用统计"卡片
```

## 📋 Excel文件要求

### 必需字段

您的Excel文件必须包含以下字段:

| 字段名 | 说明 | 示例 |
|--------|------|------|
| **商家名称** 或 **店铺名称** 或 **门店名称** | 门店的名称 | 尺八武士 |
| **门店ID** 或 **门店id** | 8-10位数字 | 1300598513 |
| **结算周期** | 结算周期日期 | 2025-09-30 |
| **结算金额** 或 **结算金额(元)** 或 **代运营结算金额** | 结算金额数值 | 35.00 |

### 支持的Excel格式

✅ **标准格式**
```
第1行: 商家名称 | 门店ID | 结算周期 | 结算金额 | ...
第2行+: 数据行
```

✅ **特殊格式** (自动识别)
```
第1行: "代运营账单" (标题行，自动跳过)
第2行: 商家名称 | 门店ID | 结算周期 | 结算金额 | ...
第3行+: 数据行
```

### 实际案例

使用项目中的测试文件:
```
5349094916_20250921_20251007代运营固定费用账单_1759889236749.xlsx
```

该文件字段结构:
```
商家名称 | 门店ID | 合同号 | 合同状态 | 结算金额 | ... | 结算周期
```

## 📊 使用步骤

### 1. 上传Excel文件

**方式A: 拖拽上传**
- 将Excel文件直接拖拽到上传区域

**方式B: 点击选择**
- 点击上传区域，选择Excel文件

### 2. 输入门店ID

在右侧"门店ID列表"输入框中输入门店ID，**每行一个**:

```
1300598513
1303600710
1295127065
534322542
533124619
```

**批量输入技巧**:
1. 打开Excel文件
2. 选择"门店ID"列的数据
3. 复制 (Ctrl+C)
4. 粘贴到输入框 (Ctrl+V)

### 3. 设置绩效比例 (可选)

在"绩效计算"卡片中:
- 默认值: 30%
- 可修改为任意百分比 (0-100)
- 实时显示绩效金额

### 4. 开始分析

点击"开始分析"按钮，系统将:
1. ✅ 读取Excel数据
2. ✅ 匹配门店ID
3. ✅ 统计结算金额
4. ✅ 计算结算周期数
5. ✅ 显示统计结果

### 5. 查看结果

**实时统计卡片** (页面顶部):
- 🟣 查询门店总数
- 🟢 找到数据门店
- 🟠 总结算周期数
- 🔴 结算金额汇总

**详细表格** (页面中部):
- 每个门店的详细统计
- 匹配状态标识
- 数据行数统计

### 6. 导出报告

点击"导出报告"按钮:
- 📥 自动生成Excel文件
- 📅 文件名包含时间戳
- 📊 包含详细数据和汇总

导出文件名示例:
```
饿了么固定费用统计报告_20251008_1030.xlsx
```

## 💡 常见问题

### Q1: 提示"缺少结算金额字段"怎么办?

**答**: 检查您的Excel文件是否包含以下任一字段:
- `结算金额`
- `结算金额(元)`
- `代运营结算金额`

### Q2: 门店ID没有匹配到数据?

**答**: 可能的原因:
1. Excel文件中确实没有该门店的数据
2. 门店ID格式不正确(必须是8-10位数字)
3. Excel字段名不匹配

**解决方法**:
- 按F12打开浏览器控制台，查看详细日志
- 检查Excel文件中的门店ID列

### Q3: 结算周期数统计不对?

**答**: 系统按"结算周期"字段**去重统计**:
- 相同结算周期只计算1次
- 如果某门店有2条数据,但结算周期相同,则统计为1个周期

### Q4: 如何理解"未找到数据"?

**答**:
- ❌ "未找到数据" = Excel文件中没有该门店ID的记录
- ✅ "有结算" = 找到了该门店的数据

这不是错误，只是该门店在本期没有结算数据。

### Q5: 支持哪些浏览器?

**答**:
- ✅ Chrome 80+
- ✅ Firefox 75+
- ✅ Safari 13+
- ✅ Edge 80+

## 🔧 高级技巧

### 自动化批量查询

如果有大量门店ID需要查询:
1. 在Excel中整理好门店ID列表
2. 全选复制
3. 粘贴到输入框
4. 一次性分析所有门店

### 绩效计算

系统支持灵活的绩效计算:
```
绩效金额 = 总结算金额 × (绩效百分比 ÷ 100)
```

示例:
- 总金额: 1000元
- 绩效比例: 30%
- 绩效金额: 300元

### 数据验证

分析前系统会自动:
- 过滤空行和无效数据
- 验证门店ID格式
- 检查必需字段是否存在

## 📞 获取帮助

- 📖 详细文档: `README.md`
- 🚀 快速入门: `快速启动指南.md`
- 🔧 修复说明: `修复说明.md`

---

**版本**: v1.0.1
**更新时间**: 2025-10-08
**项目**: 饿了么固定费用统计
