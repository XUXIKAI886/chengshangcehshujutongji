# 饿了么门店ID统计工具

> 基于Python的饿了么代运营账单数据批量统计分析工具

## 🎯 快速使用

### 一键执行(推荐)

```bash
python run_eleme_statistics.py
```

自动完成:
- ✅ 读取Excel账单文件
- ✅ 提取所有门店ID
- ✅ 统计结算金额
- ✅ 计算绩效(30%)
- ✅ 导出Excel报告

## 📊 最新统计结果

**文件**: `5349094916_20250921_20251007代运营固定费用账单_1759889236749.xlsx`

| 指标               | 数值    |
|-------------------|---------|
| 总门店数量         | 53个    |
| 找到数据门店数     | 53个    |
| 汇总金额           | 611.10元|
| 绩效金额(30%)      | 183.33元|

## 📁 核心文件

```
├── eleme_store_statistics.py      # 核心统计类
├── run_eleme_statistics.py        # 自动化脚本 ⭐
├── 饿了么门店统计使用说明.md       # 详细文档
└── 饿了么门店统计结果_*.xlsx      # 输出报告
```

## 🔧 环境要求

```bash
pip install pandas openpyxl
```

## 💡 使用场景

### 场景1: 批量统计所有门店(推荐)
```bash
python run_eleme_statistics.py
```
自动处理文件中的所有门店ID，无需手动输入。

### 场景2: 查询指定门店
```bash
python eleme_store_statistics.py
```
交互式输入门店ID，支持多个门店用逗号分隔。

## 📈 输出示例

### 控制台输出
```
============================================================
[统计汇总]
============================================================
总门店数量: 53
找到数据门店数: 53
未找到数据门店数: 0
汇总金额: 611.10元
============================================================

[绩效计算]
   总金额: 611.10元
   绩效百分比: 30.0%
   绩效金额: 183.33元

[成功] 统计结果已导出到: 饿了么门店统计结果_20251008_102212.xlsx
```

### Excel报告(双工作表)

**工作表1: 门店统计详情**
- 门店ID
- 商家名称
- 结算金额
- 数据行数
- 匹配状态

**工作表2: 统计汇总**
- 总门店数
- 找到数据门店数
- 未找到数据门店数
- 汇总金额

## ⚙️ 自定义配置

### 修改绩效百分比
编辑 `run_eleme_statistics.py`:
```python
performance_percentage = 30.0  # 改为你需要的百分比
```

### 修改数据源文件
编辑脚本中的:
```python
excel_path = r"E:\Augment\jixiaotongji\你的文件名.xlsx"
```

## 🔍 关键特性

- **智能识别**: 自动识别Excel列结构，避免编码问题
- **批量处理**: 一次性处理所有门店ID
- **精确匹配**: 基于门店ID精确匹配，避免商家名称变更问题
- **数据汇总**: 自动计算每个门店的结算金额总和
- **绩效计算**: 支持自定义绩效百分比
- **报告导出**: 自动生成Excel统计报告

## 📝 数据格式

Excel文件标准格式:
```
列0: 商家名称
列1: 门店ID (8-10位整数)
列4: 结算金额 (支持正负数)
```

## 🎓 技术亮点

- **Pandas数据处理**: 高效处理Excel数据
- **列索引访问**: 避免中文列名编码问题
- **异常处理**: 完善的错误处理机制
- **自动化流程**: 减少人工操作，提高效率

## 📞 帮助文档

详细使用说明请查看: [饿了么门店统计使用说明.md](./饿了么门店统计使用说明.md)

---

**开发**: 呈尚策划数据统计系统
**日期**: 2025-10-08
**版本**: v1.0.0
